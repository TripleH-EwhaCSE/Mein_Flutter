# -*- coding: utf-8 -*-
"""Untitled3.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1_c6D38LKlyZijOe_rXasfskXuxX75HKw
"""

import urllib.request 
import json 
import pandas as pd 
from pandas.io.json import json_normalize 
import numpy as np
import re
from collections import Counter
from nltk.tokenize import word_tokenize 
#!pip install nltk
import nltk
nltk.download('punkt')

url_1 = "http://openapi.foodsafetykorea.go.kr/api/7930a7d02b794e0d8a89/COOKRCP01/json/1/1000"
url_2 = "http://openapi.foodsafetykorea.go.kr/api/7930a7d02b794e0d8a89/COOKRCP01/json/1001/1500"

# url을 불러오고 이것을 인코딩을 utf-8로 전환하여 결과를 받자.
response_1 = urllib.request.urlopen(url_1) 
json_str_1 = response_1.read().decode("utf-8")

response_2 = urllib.request.urlopen(url_2) 
json_str_2 = response_2.read().decode("utf-8")

# 받은 데이터가 문자열이라서 이를 json으로 변환한다.
json_object_1 = json.loads(json_str_1)
json_object_2 = json.loads(json_str_2)

# ['CardSubwayStatsNew']['row']를 데이터프레임 df로 불러오는 것은 아래와 같다.
df_1 = pd.json_normalize(json_object_1['COOKRCP01']['row'])
df_2 = pd.json_normalize(json_object_2['COOKRCP01']['row'])

df_1_2 = df_1.loc[:, ['RCP_NM', 'RCP_PARTS_DTLS', 'ATT_FILE_NO_MAIN']]
df_2_2 = df_2.loc[:, ['RCP_NM', 'RCP_PARTS_DTLS', 'ATT_FILE_NO_MAIN']]

df_final = pd.concat([df_1_2 , df_2_2], ignore_index=True)

df_final

df_final.head()

#재료 데이터에서 한글만 남기고 없애기(계량 이런거)
num=0
for i in df_final['RCP_PARTS_DTLS'] :
    df_final['RCP_PARTS_DTLS'][num]=re.sub(pattern='[^ㄱ-ㅎ|ㅏ-ㅣ|가-힣|\n, ]',repl='',string=i)
    #[^a-zA-Z,] 은 알파벳과 ',' 그리고 공백을 제외하고 모두 지우겠다는 의미.
    num+=1

df_final["RCP_PARTS_DTLS"] = df_final["RCP_PARTS_DTLS"].str.replace(pat=r'[^\wA-Za-z0-9]', repl=r',', regex=True)

df_final

df3 =df_final["RCP_PARTS_DTLS"].str.replace(pat=r',', repl=r' ', regex=True)

df3

df_3_1 = []
for i in range(len(df3)):
  df_3_1.append(' '.join(df3[i].split()))

df_3_1_1 = []
for i in range(len(df3)):
  df_3_1_1.append(' '.join(df3[i].split()))

df_3_1_1

df_3_df = pd.DataFrame(df_3_1_1)

df_3_df

STOP_WORDS = set(['','다진','개', '작은술', '컵', '모', '알', '약간','큰술','잎','삶기','봉지','줄기','소스', '적당량', '마리','다진것' ])

STOP_WORDS_2 = set(['', ' ', '다진','개', '작은술', '컵', '모', '알', '약간','큰술','잎','삶기','봉지','줄기','소스', '적당량', '액기스', '마리','다진것','동초', '가는', '무가당', '우린', '불린', '가능', '오색준비', '찜', '국물용', '큰', '술', '기둥','카나페', '다리', '케이싱', '결들임', '촛물', '머위대', '인분', '구운', '익은', '소재료', '홍',
                '주재료', '장', '양념', '재료', '쪽', '장식', '곁들임', '소스소개', '드레싱', '붉은', '빨강', '국물', '뒤포리밴댕이' , '펜네', '같은', '우스터소스', '색', '씨드', '고기양념', '쪄진', '쇠고기구이용', '하수오', '풋', '초록', '퓨레', '맛장', '노란색', '속껍질', '껍질', '분량', '타가토스', '코리앤더', '유산지', '장식재료선택', '스위스', 
                  '노랑', '불린', '마른', '흰', '썬', '삶은', '새싹', '플레인', '속재료', '소', '반죽재료', '배개', '곤약', '가슴살', '것', '돈까스소스', '과일', '또는', '토핑', '식용', '꼬치개', '레시틴가루', '뿌리', '포기', '청각', '굵게', '해독주스', '울금', '절일', '맞출', '발효종', '꽃노란색', '국물재료', '적당량소야소스', '채친것', '삶은것', '분말', '즙', '효모',
                  '통조림', '공기', '볶은', '수삼', '저염', '밑간', '건', '토막', '부재료', '으깬', '조각', '가닥', '청', '고운', '굵은', '말린', '간', '베이스', '수플레', '패이스트리', '튀김', '앞다리살', '무침양념','코리앤더씨', '구이', '폭두께', '르네디종', '치킨양념소스', '전립분', '새뱅이', '비스킷재료', '베이킹', '앤다이브', '청색', '초대리', '새콤', '달콤', 
                  '송송', '백일송이', '슬라이스', '각', '비타민', '새송이', '미니', '식용꽃', '조', '간편', '주황', '노란', '캔', '소량', '절임물', '살', '없는', '부위', '우민찌', '불린것', '밑동', '검은', '삶는', '흰색', '오리엔탈소스', '판', '두', '일본', '불린수수', '얼린', '볶음', '무염', '빨간', '드라이이스트레드', '저염양념', '블랙', '익힌', '물을', '동량으로', '하여', '중불에서', '서서히', '녹인다',
                  '가루', '씩', '패주', '영콘', '채', '냉이', '송이', '칵테일', '각각', '정사각형', '부순', '수수', '드라이', '정향', '조리양념', '구이소', '반죽', '사방', '기타', '품은', '나물준비', '스위트칠리', '약재', '스틱', '이태리시즈닝', '자청', '단촛물', '주스', '납작', '젖은', '사용', '토핑재료', '생각', '컴', '절임', '디포리', '돈민찌', '믹서에', '갈아줌', '기호에', '만든다',
                  '파인소프트', '노른자', '플렌타', '디존', '데침', '반죽', '채소준비', '페이스트', '인스턴트', '파르메산', '저나트륨', '백태', '몸통', '때', '각종', '차', '따뜻한', '타임', '곁들이', '홀그레인', '핫소스', '황기', '갓', '오가피', '말이', '완숙', '연두', '시판', '타임마른것', '찐', '강력', '제스트', '녹인', '잘게', '갠것', '적장량',
                  '데친', '얇게', '샐러드소스', '링개', '유기농', '생', '시럽', '파우더', '마른것', '오색지라시', '건조', '손질', '맞게', '산적', '진한' , '볶은수수', '브릴레', '핫', '찰반죽용', '팬케이크', '볼', '샤브육수용', '그라탕', '거피한', '실치', '반죽양념', '페스트', '손질된', '스파이스', '해선장', '없는', '갠', '플레이크', '데쳐서', '딜',
                  '유', '제거용', '쓴', '소스소개저나트륨', '스테이크재료', '냉스프', '르뱅', '튀김소스', '화이트크림', '약간씩쿠아카몰', '찜기', '김밥용', '소개', '에멘탈', '잡뼈', '삼색매작과', '어슷', '새콤달콤', '쪄진', '뿌리', '냉동', '조림양념', '구이소스', '갈은', '차이브', '머윗대', '낸', '무게', '발효원종', '꼬치', '꼬치용', '갈은것', '포항초', '대나무',
                  '곁들이장', '삼색분말각', '나무막대기개', '두가지', '단단한', '화이트', '바난', '레즈와즈', '야콘', '는', '적당량소스', '불릴', '장식용', '흰살','재울', '구울', '꽃', '화지타', '단', '발', '병', '엔다이브', '잡채양념배', '밑', '베이킹소다', '제빵개량제', '손질한', '팩', '쌈', '전', '알긴산', '염화칼슘', '뼈',' 장식용' ,'머리와', '봉골레', '볶음양념', '천연조미료', '소장', '일식', '채썬', '수제조미료', '폴렌타', '페레멘테', '파트'
                  ])

C_WORDS_SET_1 = [['후춧가루', '후추'], ['저염간장', '간장'], ['올리브오일', '올리브유'], ['홍고추', '고추'], ['표고버섯', '버섯'], ['사골육수', '쇠고기'], ['레몬제스트', '레몬'], ['불린쌀', '쌀'], ['다진쇠고기', '쇠고기'], ['고구마죽','고구마'],
                    ['청양고추', '고추'], ['청고추', '고추'], ['소금적당량', '소금'], ['흰후추', '후추'], ['느타리버섯', '버섯'], ['마른표고버섯', '버섯'], ['오렌지소스', '오렌지'], ['생표고버섯', '버섯'], ['블랙올리브', '올리브'], 
                    ['양송이버섯', '버섯'], ['빵가루', '빵'], ['청피망', '피망'], ['새송이버섯', '버섯'], ['팽이버섯', '버섯'], ['그린올리브', '올리브'], ['시금치우유', '우유'], ['옥수수전분', '전분'], ['풋고추개', '고추'], ['저염고추장', '고추장'],
                    ['대파', '파'], ['레몬즙', '레몬'], ['통깨', '깨'], ['방울토마토', '토마토'], ['다진마늘', '마늘'], ['애호박', '호박'], ['메추리알개', '달걀'], ['꼬막살', '해산물'], ['어린이치즈', '치즈'], ['깐실파', '파'], ['저염리코타치즈', '치즈'],
                    ['닭가슴살', '닭고기'], ['밥', '쌀'], ['유자청', '유자'], ['소고기', '쇠고기'], ['찹쌀가루', '쌀'], ['쪽파', '파'], ['소고기안심', '쇠고기'], ['닭고기다리살', '닭고기'], ['통삼겹살', '돼지고기'], ['에그누들', '달걀'], ['순무', '무'],
                    ['생강즙', '생강'], ['팽이버섯', '버섯'], ['맛간장', '간장'], ['달걀개', '달걀'], ['레몬개', '레몬'], ['찹쌀', '쌀'], ['그라나파다노치즈', '치즈'], ['당귀잎', '채소'], ['두부완자', '두부'], ['치킨육수', '닭고기'], ['밀가루중력분', '밀가루'],
                    ['홍피망', '피망'], ['마늘다진것', '마늘'], ['통후추', '후추'], ['카레가루', '카레'], ['튀김기름', '식용유'], ['국간장', '간장'], ['돼지고기안심', '돼지고기'], ['자숙새우', '새우'], ['깐밤', '밤'], ['흑마늘액', '마늘'], ['건고추', '고추'],
                    ['저염된장', '된장'], ['파슬리가루', '파슬리'], ['매실청', '매실'], ['생강청', '생강'], ['다진양파', '양파'], ['레드와인', '와인'], ['황금팽이버섯', '버섯'], ['잔멸치', '멸치'], ['고등어마리', '생선'], ['시금치가루', '채소'], ['건조미역줄기', '미역'],
                    ['실파', '파'], ['양송이', '버섯'], ['쑥갓', '쑥'], ['완두콩', '콩'], ['화이트와인', '와인'], ['실곤약', '곤약'], ['허브소금', '소금'], ['스파게티면', '면'], ['조선무', '무'], ['돼지사태', '돼지고기'], ['멕시코고추', '고추'],
                    ['계란', '달걀'], ['건다시마', '다시마'], ['현미', '쌀'], ['브로컬리', '브로콜리'], ['월계수잎', '월계수'], ['파프리카빨강',  '파프리카'], ['감식초', '식초'], ['생선살', '생선'], ['아귀', '생선'], ['숙주나물', '숙주'], ['가레떡', '떡'], ['조기', '생선'],
                    ['샐러드', '채소'], ['새싹채소', '채소'], ['곁들임채소', '채소'], ['플레인요거트', '요거트'], ['애호박개', '호박'], ['백후추', '후추'], ['소고기우둔살', '쇠고기'], ['생강가루', '생강'], ['홍고추다진갓', '고추'], ['소불고기', '쇠고기'],
                    ['깨소금', '소금'], ['홍파프리카', '파프리카'], ['주꾸미', '오징어'], ['참나물', '나물'], ['깻잎장', '깻잎'], ['무순', '무'], ['노란파프리카', '파프리카'], ['양파개', '양파'], ['관자구이', '해산물'], ['돼지고기삽겹살', '돼지고기'],
                    ['닭', '닭고기'], ['대추알', '대추'], ['새우마리', '새우'], ['건새우', '새우'], ['들깻가루', '깨'], ['표고버섯개', '버섯'], ['쇠고기우둔', '쇠고기'], ['땅콩버터', '땅콩'], ['어린잎채소약간', '채소'], ['홍고추마른것', '고추'], ['오리고기훈제오리', '오리고기'],
                    ['함초', '채소'], ['백김치', '김치'], ['볶은소금', '소'], ['순두부', '두부'], ['칵테일새우', '새우'], ['콩가루', '콩'],['초간장', '간장'], ['소면', '면'], ['호박가루', '호박'], ['물녹말', '전분'], ['대파뿌리', '파'], ['동치미국물', '김치'], 
                    ['강력분', '밀가루'], ['후추적당량', '후추'], ['닭고기가슴살', '닭고기'], ['달걀흰자', '달걀'], ['아스파라거스개', '아스파라거스'],['적파프리카', '파프리카'], ['바질가루', '바질'], ['파뿌리', '파'], ['자몽개', '자몽'], ['드라이이스트', '이스트'], ['소고기홍두깨살', '쇠고기'],
                    ['오렌지주스', '오렌지'], ['국멸치', '멸치'], ['검은콩', '콩'], ['단호박개', '단호박'], ['모짜렐라치즈', '치즈'], ['연두부', '두부'], ['저나트륨된장소스된장', '된장'], ['오미자청', '오미자'], ['참치살', '참치'], ['우동면', '면'], ['함초가루', '함초'], ['생선육수', '생선'],
                    ['닭고기살', '닭고기'], ['홍고추개', '고추'], ['파마산치즈', '치즈'], ['영양부추', '부추'], ['겨자가루', '머스터드'], ['삼겹살', '돼지고기'], ['돼지고기불고기용', '돼지고기'], ['흰쌀', '쌀'], ['도미', '생선'], ['돼지고기목살', '돼지고기'], ['쇠고기양지', '쇠고기'],
                    ['크림치즈', '치즈'], ['스파게티', '면'], ['당면', '면'], ['메추리알', '달걀'], ['어간장', '간장'], ['떡볶이떡', '떡'], ['느타리', '버섯'], ['넛맥가루', '넛맥'], ['무염치즈', '치즈'], ['쇠갈비살', '쇠고기'], ['골뱅이', '해산물'], ['치킨', '닭고기'],
                    ['낙지', '오징어'], ['저염소금', '소금'], ['새우살', '새우'], ['양파다진것', '양파'], ['레몬주스', '레몬'], ['사과식초', '식초'], ['깐대파', '파'], ['레디쉬개', '레디쉬'], ['흰살생선', '생선'], ['간장소스', '간장'], ['고추냉이', '와사비'],
                    ['미니파프리카', '파프리카'], ['굴소스', '해산물'], ['건표고버섯', '버섯'], ['월계수잎장', '월계수'], ['달걀노른자', '달걀'], ['된장양념', '된장'], ['미소된장', '된장'], ['쌈무','무'], ['호박고구마', '고구마'], ['주키니호박', '호박'], ['보리새우', '새우'],
                    ['오렌지개', '오렌지'], ['흰후춧가루', '후추'], ['홍초', '식초'], ['전복', '해산물'], ['관자','해산물'], ['무염버터', '버터'], ['돼지등심', '돼지고기'], ['꽁치', '생선'], ['구운채소','채소'], ['흑두부', '두부'], ['돼지', '돼지고기'], ['부침가루', '밀가루'],
                    ['요구르트', '요거트'], ['인삼뿌리', '인삼'], ['두릅', '채소'], ['취나물', '나물'], ['감자전분', '전분'], ['다진소고기', '쇠고기'], ['잣알', '잣'], ['오레가노마른것', '오레가노'], ['고추장소스', '고추장'], ['열무김치', '김치'], ['닭봉', '닭고기'], ['옥수수콘', '옥수수'], ['설탕시럽', '설탕'], 
                    ['파슬리다진것', '파슬리'], ['보리된장', '된장'], ['녹말', '전분'], ['흑설탕', '설탕'], ['토마토페이스트', '토마토'], ['강황가루', '카레'], ['취나물밥', '취나물'],
                    ['발사믹소스', '발사믹'], ['목이버섯', '버섯'], ['새우젓', '새우'], ['사과개', '사과'], ['코다리', '생선'], ['스테이크', '쇠고기'], ['땅콩가루', '땅콩'], ['레몬소금', '소금'], ['바질다진것', '바질'], ['건멸치', '멸치'], ['검정깨묵', '깨'], ['북어', '생선'],
                    ['등심','쇠고기'], ['저염치즈', '치즈'], ['배즙', '배'], ['맵쌀', '쌀'], ['통마늘', '마늘'], ['천일염', '소금'], ['계피가루', '계피'], ['물전분', '전분'], ['다시마롤', '다시마'], ['자색고구마', '고구마'], ['황태포', '황태'], ['황태머리', '황태'], ['홍피망다진것', '피망'],
                    ['카스텔라', '빵'], ['피밍', '피망'],['영양밥', '쌀'], ['닭뼈','닭고기'], ['표고버섯마른것', '버섯'], ['된장소스', '된장'], ['푸실리', '파슬리'], ['레몬소스', '레몬'], ['미니양배추', '양배추'], ['흰설탕', '설탕'], ['쌈다시마', '다시마'], ['만두소', '밀가루'], ['소라', '해산물'],
                    ['멸치육수', '멸치'], ['연겨자', '머스터드'], ['양송이버섯개', '버섯'], ['방울토마토개', '토마토'], ['적채', '채소'], ['보리', '쌀'], ['누룽지', '쌀'], ['머스터드소스', '머스터드'], ['갑오징어', '오징어'], ['식물성기름', '식용유'], ['토란', '채소'], ['꼬막', '해산물'], ['마늘즙', '마늘'],
                    ['황설탕', '설탕'], ['알배추', '배추'], ['곤드레나물', '나물'], ['삼치', '생선'], ['가지색', '가지'], ['곁들이채소', '채소'], ['쇠고기우둔살', '쇠고기'], ['매실고추장', '고추장'], ['오이고추', '고추'], ['가자미살', '생선'], ['캔옥수수', '옥수수'], ['파스타', '면'], ['국수', '면'],
                    ['레몬껍질', '레몬'], ['노랑파프리카', '파프리카'], ['고등어', '생선'], ['통후추알', '후추'], ['청국장가루', '청국장'], ['치즈가루', '치즈'], ['조개', '해산물'], ['플레인요구르트', '요거트'], ['약간장', '간장'], ['발사믹크림', '발사믹'], ['무염피스타치오', '피스타치오'], ['백일송이버섯', '버섯'],
                    ['청파프리카', '파프리카'], ['포도주스', '포도'], ['파프리카개', '파프리카'], ['적양파', '양파'], ['식빵', '빵'],['굴', '해산물'], ['대두유', '콩'], ['꽈리고추', '고추'], ['조랭이떡', '떡'], ['마늘종', '마늘'], ['조갯살', '해산물'], ['광어마리', '생선'], ['요리술', '맛술'], ['국수반죽', '면'],
                    ['오레가노', '치즈'], ['가지개', '가지'], ['쌀밥', '쌀'], ['가다랑어포', '해산물'], ['아몬드슬라이스','아몬드'], ['닭고기마리', '닭고기'], ['판젤라틴장', '젤라틴'], ['묵은지', '김치'], ['차돌박이', '돼지고기'], ['조청', '올리고당'], ['캔참치', '참치'], ['콩백태', '콩'], ['배합초', '식초'], 
                    ['파다진것', '파'], ['생강다진것', '생강'], ['건미역', '미역'], ['호상요구르트', '요거트'], ['배추김치', '김치'], ['메밀면', '메밀'],['날콩가루', '콩'], ['라임주스', '라임'], ['새우가루', '새우'], ['무말랭이', '무'], ['대하마리', '새우'], ['세발나물', '나물'], ['얼갈이배추', '배추'],
                    ['건포도', '포도'], ['날치알', '해산물'], ['중력분', '밀가루'], ['통삼겹', '돼지고기'], ['애느타리버섯', '버섯'], ['물녹말녹말가루', '밀가루'], ['모시조개', '해산물'], ['겨자', '머스터드'], ['죽', '쌀'], ['초밥', '쌀'], ['곤약잡곡밥', '쌀'], ['약간나물데침', '나물'], ['토란대', '토란'], ['실고추약간', '고추'],
                    ['사과주스', '사과'], ['안심', '쇠고기'], ['마늘오일', '마늘'], ['잡곡밥', '쌀'], ['다시마육수', '다시마'], ['장어', '생선'], ['애플민트', '민트'], ['저지방우유', '우유'], 
                    ['상추', '채소'], ['백미', '쌀'], ['미니새송이버섯', '버섯'], ['사워크림', '샤워크림'], ['저염버터', '버터'], ['배춧잎장', '채소'], ['양파즙', '양파'],['통계피', '계피'], ['키위소스', '키위'],
                    ['현미쌀', '쌀'], ['쇠고기다진것', '쇠고기'], ['홀토마토', '토마토'], ['치작가루', '치자'], ['달래', '채소'], ['연어훈제연어', '연어'], ['모짜렐라', '치즈'], ['콩기름', '식용유'],
                    ['치즈장', '치즈'], ['아보카도개', '아보카도'], ['액젓', '해산물'], ['피자치즈', '치즈'], ['피클', '오이'], ['멸치가루', '멸치'], ['녹차가루', '녹차'], ['꽃게', '해산물'], ['기름', '식용유'],
                    ['깐양파', '양파'], ['우리밀가루', '밀가루'], ['곶감', '감'], ['검정깨', '깨'], ['빨강파프리카', '파프리카'], ['관자개', '해산물'], ['쥬키니호박', '호박'], ['토마토콩카세', '토마토'],
                    ['흑미', '쌀'], ['전복개', '해산물'], ['후추약간', '후추'], ['쇠고기등심', '쇠고기'], ['귀리밥', '쌀'], ['동태포', '황태'], ['다진홍고추', '고추'], ['고기', '쇠고기'], ['쌀가루', '쌀'],
                    ['다진청고추', '고추'], ['청고추다진것', '고추'], ['소라살', '해산물'], ['버섯마늘소금', '버섯'], ['문어', '해산물'], ['귀리', '쌀'], ['해초', '미역'], ['다진파', '파'], ['청피망다진것', '피망'],
                    ['파마산치즈가루', '치즈'], ['게맛살', '해산물'], ['비름나물', '나물'], ['매실엑기스', '매실'], ['양지', '돼지고기'], ['호박잎장', '채소'], ['절임물', '물'], ['조미술', '맛술'], ['바질마른것', '바질'],
                    ['현미찹쌀', '쌀'], ['흑마늘', '마늘'], ['셀러리', '샐러리'], ['닭다리살', '닭고기'], ['판젤라틴', '젤라틴'], ['새우대하', '새우'], ['황태채', '황태'], ['머스타드', '머스터드'], ['다진생강', '생강'],
                    ['파프리카가루', '파프리카'], ['갈비', '돼지고기'], ['아욱', '채소'], ['떡갈비', '돼지고기'], ['가자미', '생선'], ['오이피클', '오이'], ['피클', '오이'], ['해물육수', '해산물'], ['깐생강', '생강'],
                    ['밤고구마', '고구마'], ['젓갈', '해산물'], ['모차렐라치즈', '치즈'], ['조림장', '간장'], ['메밀국수', '메밀'], ['볶은현미', '쌀'], ['전분가루', '전분'], ['비네그레트', '식초'], ['크림소스', '우유'],
                    ['소고기등심', '쇠고기'], ['일본된장', '된장'], ['달걀물', '달걀'], ['파슬리가루약간', '파슬리'], ['래디쉬', '무'], ['레디쉬', '무'], ['튀김가루', '밀가루'], ['실고추', '고추'], ['리코타치즈', '치즈'],
                    ['멸치액젓', '멸치'], ['마늘가루', '마늘'], ['삼계탕', '닭고기'], ['저염베이컨', '베이컨'], ['청홍고추', '고추'], ['피클링스파이스', '오이'], ['다시마물', '다시마'], ['돼지고기사태', '돼지고기'], ['병아리콩', '콩'],
                    ['양조식초', '식초'], ['백년초가루', '백년초'], ['밀가루빅백분', '밀가루'], ['요리당', '올리고당'], ['베이비채소', '채소'], ['크림', '우유'], ['사과즙', '사과'], ['당근다진것', '당근'], ['보리쌀', '쌀'],
                    ['돼지고기등심', '돼지고기'], ['다시마국물', '다시마'], ['양조간장', '간장'], ['대구살', '생선'], ['라이스페이퍼장', '라이스페이퍼'], ['진간장', '간장'], ['저염국간장', '간장'],
                    ['메밀가루', '메밀'], ['동태살','황태'], ['블루베리잼','블루베리'], ['슬라이스햄', '햄'], ['다시멸치', '멸치'],['녹말물', '전분'], ['휘핑크림', '우유'], ['소금약간', '소금'],
                    ['북어채', '황태'], ['어묵', '생선'], ['통밀가루', '밀가루'], ['천도복숭아', '복숭아'], ['잎채소', '채소'], ['콩비지', '두부'], ['김치국물', '김치'], ['까나리액젓', '해산물'], ['잣가루', '잣'], ['알마늘', '마늘'],
                    ['강낭콩', '콩'], ['닭육수', '닭고기'], ['바지락', '해산물'], ['적양배추', '양배추'], ['어린잎채소', '채소'], ['황파프리카', '파프리카'], ['새송이버섯개', '버섯'], ['함초소금', '소금'], ['현미유', '식용유'], ['청경채', '채소'],
                    ['마늘기름', '마늘'], ['다진대파', '파'], ['검은깨', '깨'],['토마토소스','토마토'], ['소', '쇠고기'], ['고사리', '나물'], ['홍합', '해산물'], ['바나나개', '바나나'],
                    ['라면', '면'],['더덕', '나물'],['토마토케첩', '케첩'], ['청포묵', '묵'],['홍시', '감'], ['카놀라유', '식용유'], ['만두피', '밀가루'],  ['멥쌀', '쌀'],['쌀뜨물', '쌀'],['크랜베리', '크렌베리'], ['박력분', '밀가루'],
                    ['돌나물', '나물'], ['겨자', '머스터드'], ['깐마늘', '마늘'], ['치자가루', '치자'], ['기름', '식용유'], ['미림', '맛술'], ['팥', '콩'], ['소주', '맛술'], ['레드와인식초', '식초'], ['들깨', '깨'],['바닐라에센스', '바닐라'], ['도토리묵', '묵'], ['산마', '마'],
                    ['다진돼지고기', '돼지고기'], ['머스타드', '머스터드'],['크렌베리', '크랜베리'], ['딸기잼', '딸기'], ['죽순', '소금'], ['매생이', '미역'], ['포도씨유', '식용유'],['산딸기', '딸기'],['밀', '밀가루'],
                    ['돼지고기삼겹살', '돼지고기'], ['가래떡', '떡'], ['바지락살', '해산물'],['망고퓨레', '망고'],['현미밥', '쌀'], ['홍고추다진것', '고추'],['바닐라빈', '바닐라'], ['춘권피', '밀가루'], ['당근파리지엔', '당근'],['비빔고추장', '고추장'],['흑미밥', '쌀'],['해물', '해산물'],['메주콩', '콩'],
                    ['돌미나리', '나물'], ['오이무침', '오이'], ['올리브마늘', '마늘'],['닭가슴살롤', '닭고기'], ['마른메밀국수', '메밀'],['젤리', '젤라틴'],['오징어먹물', '오징어'],['구운고등어', '생선'],['저염햄', '햄'], ['통조림참치', '참치'], ['멥쌀가루', '쌀'],
                    ['복분자가루', '복분자'],['쿠스쿠스샐러드', '쿠스쿠스'],['단호박무스', '단호박'], ['브리또', '밀가루'], ['쇠우둔살쌈', '쇠고기'], ['파인애플즙', '파인애플'],['라따뚜이', '가지'],['잡곡누룽지', '쌀'],['쇠고기홍두깨살', '쇠고기'],
                    ['카레가루', '카레'],['고기완자양념', '쇠고기'],['후르츠칵테일', '과일'],['대파채', '파'],['다진쪽파', '파'],['국수', '면'],['꽁보리밥', '쌀'], ['달래무침', '나물'],['감장', '감자'],['루꼴라', '채소'],['소고기살치살', '쇠고기'], ['주먹밥', '쌀'],
                    ['연어캔', '연어'], ['양념족발', '돼지고기'], ['두부볶음', '두부'], ['생들기름', '들기름'],['볶은율무', '율무'], ['마른고추', '고추'], ['샐러리개', '샐러리'],['식초약간', '식초'], ['키위샐러드', '키위'], ['마고구마참치', '참치'], ['가지연근', '가지'], ['블랙올리브개', '올리브'],
                    ['오미자물', '오미자'], ['지단', '달걀'],['미트소스', '쇠고기'],['버섯볶음', '버섯'],['닭다리구이', '닭고기'],['닭다리', '닭고기'],['간장요거트', '요거트'], ['새우소금', '새우'],['쇠고기사태살', '쇠고기'],['염장다시마', '다시마'],  ['저나트륨파인애플소스파인애플', '파인애플'],
                    ['래디시', '레디쉬'], ['저염재래된장', '된장'],['돼지고기앞다리살', '돼지고기'],['호박고구마스프', '고구마'], ['소안심살', '쇠고기'],['쇠갈비', '쇠고기'],['새우볶음밥', '새우'],['시나몬가루', '계피'],['면발', '면'], ['실파송송썬것', '파'],
                    ['레드와인', '와인'], ['그래놀라', '오트밀'], ['무조림', '무'], ['호박찜', '호박'],['당근퓨레', '당근'], ['쇠고긱', '쇠고기'],['무화과발사믹', '발사믹'],['불고기', '쇠고기'],['우뭇가사리', '미역'],['야채육수', '채소'], ['매운고추소스매운', '고추'],
                    ['두부크루통', '두부'], ['먹물', '오징어'],['완두콩알', '콩'],['천사채', '미역'],['홍합살', '해산물'],['김장김치', '김치'],['울금가루', '울금'], ['루콜라', '루꼴라'],['칵텔새우', '새우'], ['맛소금', '소금'], ['소금적당량멸치액적소스멸치액젓', '멸치'],
                    ['건당면', '면'],['전복살', '해산물'],['자른미역', '미역'],['양배추개', '채소'],['블랙올리브알', '올리브'],['다슬기살', '해산물'], ['호박잎', '호박'], ['고구마개', '고구마'], ['돼지고기등갈비', '돼지고기'],['건도토리묵', '묵'], ['곰취쌈', '곰취'],
                    ['뿌리채소조림', '채소'], ['레디시', '레디쉬'], ['잎녹차', '녹차'], ['귤껍질', '귤'],['건표고', '버섯'], ['주황파프리카', '파프리카'],['파래김', '김'],['후춧가루약간', '후추'], ['쇠고긱', '쇠고기'], ['로즈마리마른것', '로즈마리' ] , ['선택황설탕', '황설탕'],
                    ['블루베리퓨레', '블루베리'],['카카오', '초콜릿'],['스펀지케익', '빵'],['생새우', '새우'],['곁들임채소대디쉬', '레디쉬'],['키엔페퍼', '후추'],['소스소개드래싱마요네즈', '마요네즈'],['청홍고추다진것', '고추'],['쭈꾸미', '해산물'],['돼지고기전지', '돼지고기'],
                    ['찜소스다시마국물', '다시마'],['멸치중간것', '멸치'], ['케쳡', '케첩'],
                    ['저나트륨칠리소스두반장','두반장'],['찰깨빵', '빵'], ['자몽주수', '자몽'],['슈거', '설탕'],['소고기양지', '쇠고기'],['알토란', '토란'],['돼지고기살코기', '돼지고기'],['햄다진것', '햄'],['소고기', '쇠고기'], ['소스소개요거트파슬리소스플레인요거트', '요거트'],
                    ['돈육분쇄육', '돼지고기'],['삼계탕용', '닭고기'], ['샐러리다진것', '샐러리'], ['당면', '면'], ['돈육보쌈용', '돼지고기'], ['생밤', '밤'], ['백련초가루', '백련초'], ['무파리지엔', '무'],['단호박파리지엔', '단호박'], ['대나무꼬치', '대나무'],
                    ['파프리카빨강노랑', '파프리카'], ['통후추부순것', '후추'], ['살생선', '생선'], ['양파작게자른것', '양파'], ['데미클라스', '데미글라스'], 
                    ['닭토막', '닭고기'],['감귤', '귤'], ['이스트골드', '이스트'], ['달걀노른자개', '달걀'], ['상추', '채소'],['케이엔페퍼약간', '후추']]

ingredient2 = pd.read_csv('/content/drive/MyDrive/ing_cnt_3.csv', encoding= 'UTF-8', header= None)

ing_df = pd.DataFrame(ingredient2, columns= [0, 1])
ing_list = ing_df.values.tolist()

ing_list

C_WORDS_SET = C_WORDS_SET_1 + ing_list

x_data = np.array(df_3_1_1)

#불용어제거
for i, document in enumerate(x_data):
    clean_words = [] 
    final_words = []
    for word in nltk.tokenize.word_tokenize(document): 
      if word not in STOP_WORDS_2: #불용어 제거
        for change_word_set_2 in C_WORDS_SET:
          if word == change_word_set_2[0]:
            word = change_word_set_2[1]
        clean_words.append(word)
    #print(clean_words)
    for j in clean_words:
      if j not in final_words:
        final_words.append(j)
    print(final_words)
    x_data[i] = ' '.join(final_words)

x_data

ingredient = pd.DataFrame(x_data)

ingredient

result = ingredient[0].str.split(' ')

result = result.apply(lambda x: pd.Series(x))
result

df_real_final = df_final.loc[:, ['RCP_NM', 'ATT_FILE_NO_MAIN']]

ing_final = pd.concat([df_real_final,result],axis=1)

ing_final

df_si_level = ing_final.reset_index(columns = ['RCP_NM' , 'ATT_FILE_NO_MAIN'] )
  
print(df_si_level.head())

ing_final.to_excel(r'ing_final.xlsx', index =False)

ing_all = []
for ing_loc in x_data:
  data_sptd = ing_loc.split(' ')
  for ing in data_sptd:
    ing_all.append(ing)

cnt = Counter(ing_all)

len(cnt)

cnt_df = pd.DataFrame.from_dict(cnt, orient='index').reset_index()
cnt_df = cnt_df.rename(columns={'index':'names', 0:'cnt'})

cnt.most_common(1460)



cnt_df.to_excel(r'ing_cnt_final.xlsx', index = False)

ingredient2

떡볶이 = ing_final.loc[ing_final['RCP_NM'].str.contains('순두부')]

떡볶이

떡볶이.to_excel(r'떡볶이.xlsx', index = False)

from pandas.io import gbq

